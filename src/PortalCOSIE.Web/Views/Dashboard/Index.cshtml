@{
    ViewData["Title"] = "Dashboard";
}

<style>
    :root {
        --primary: #5A1236;
        --secondary: #721845;
        --accent: #FF6B35;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        --radius: 10px;
    }

    .stat-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: var(--radius);
        border-left: 4px solid var(--accent);
        overflow: hidden;
    }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

    .chart-container {
        position: relative;
        height: 250px;
        width: 100%;
    }

    .chart-card {
        border-radius: var(--radius);
        transition: box-shadow 0.3s ease;
    }

        .chart-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

    .doc-item {
        border-left: 3px solid transparent;
        transition: all 0.3s ease;
    }

        .doc-item:hover {
            border-left-color: var(--accent);
            background: rgba(90, 18, 54, 0.03);
        }
</style>

<div class="dashboard">
    <!-- Sección de Estadísticas Rápidas -->
    <div class="row g-4 mb-4">
        <div class="col-md-6 col-lg-3">
            <div class="stat-card card shadow h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-2">Alumnos registrados</h6>
                            <h3 class="mb-0">2.3 <small>días</small></h3>
                        </div>
                        <i class="fas fa-user fa-2x text-info"></i>
                    </div>
                    <div class="mt-3 text-danger">
                        <i class="fas fa-arrow-down"></i> 1.2 días menos
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="stat-card card shadow h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-2">TOTAL DOCUMENTOS</h6>
                            <h3 class="mb-0">1,842</h3>
                        </div>
                        <i class="fas fa-file-alt fa-2x text-primary"></i>
                    </div>
                    <div class="mt-3 text-success">
                        <i class="fas fa-arrow-up"></i> 14.2% vs mes anterior
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="stat-card card shadow h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-2">PENDIENTES</h6>
                            <h3 class="mb-0">128</h3>
                        </div>
                        <i class="fas fa-clock fa-2x text-warning"></i>
                    </div>
                    <div class="progress mt-3" style="height: 6px;">
                        <div class="progress-bar bg-warning" style="width: 25%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="stat-card card shadow h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="text-muted mb-2">APROBADOS</h6>
                            <h3 class="mb-0">1,502</h3>
                        </div>
                        <i class="fas fa-check-circle fa-2x text-success"></i>
                    </div>
                    <div class="mt-3 text-success">
                        <i class="fas fa-arrow-up"></i> 8.7% vs mes anterior
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Gráficos Principales -->
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="chart-card card shadow h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div><h6 class="mb-0 fw-bold py-2">Actividad de documentos</h6></div>
                    <select class="form-select form-select-sm w-auto">
                        <option>Últimos 6 meses</option>
                        <option>Últimos 3 meses</option>
                        <option>Este año</option>
                    </select>
                </div>

                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="chart-card card shadow h-100">
                <div class="card-header">
                    <h6 class="mb-0 fw-bold py-2">Distribución por Tipo</h6>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentos Recientes -->
    @* <div class="row mt-4">
        <div class="col-12">
            <div class="chart-card card shadow">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-bold py-2">Documentos Recientes</h6>
                    <a href="#" class="btn btn-sm btn-outline-primary">Ver Todos</a>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <a href="#" class="list-group-item list-group-item-action doc-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1">Solicitud de Certificado</h6>
                                    <small class="text-muted">#DOC-2023-00456 • Juan Pérez</small>
                                </div>
                                <div>
                                    <span class="badge bg-success">Aprobado</span>
                                    <small class="text-muted ms-2">Hoy, 10:45 AM</small>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action doc-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1">Cambio de Carrera</h6>
                                    <small class="text-muted">#DOC-2023-00455 • María García</small>
                                </div>
                                <div>
                                    <span class="badge bg-warning text-dark">En Revisión</span>
                                    <small class="text-muted ms-2">Ayer, 3:20 PM</small>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action doc-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1">Justificante de Inasistencia</h6>
                                    <small class="text-muted">#DOC-2023-00454 • Carlos López</small>
                                </div>
                                <div>
                                    <span class="badge bg-danger">Rechazado</span>
                                    <small class="text-muted ms-2">Ayer, 11:15 AM</small>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div> *@
</div>

@section Scripts {
    <script>
        // Gráficos responsivos con resizing automático
        let activityChart, typeChart;

        function initCharts() {
            // Destruir gráficos existentes
            if (activityChart) activityChart.destroy();
            if (typeChart) typeChart.destroy();

            // Gráfico de Actividad
            activityChart = new Chart(document.getElementById('activityChart'), {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Documentos Recibidos',
                        data: [120, 190, 170, 200, 220, 180],
                        borderColor: 'rgba(90, 18, 54, 1)',
                        backgroundColor: 'rgba(90, 18, 54, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Documentos Procesados',
                        data: [100, 160, 150, 180, 200, 160],
                        borderColor: 'rgba(255, 107, 53, 1)',
                        backgroundColor: 'rgba(255, 107, 53, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            // Gráfico de Tipos
            typeChart = new Chart(document.getElementById('typeChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Certificados', 'Registros', 'Justificantes', 'Otros'],
                    datasets: [{
                        data: [35, 25, 20, 20],
                        backgroundColor: [
                            'rgba(90, 18, 54, 0.8)',
                            'rgba(255, 107, 53, 0.8)',
                            'rgba(114, 24, 69, 0.8)',
                            'rgba(108, 117, 125, 0.8)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Inicializar al cargar
        document.addEventListener('DOMContentLoaded', initCharts);

        // Redimensionar con debounce
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                initCharts();
            }, 200);
        });
    </script>
}