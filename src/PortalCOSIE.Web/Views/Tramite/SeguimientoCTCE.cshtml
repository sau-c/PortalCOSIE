@model PortalCOSIE.Domain.Entities.Tramites.DetalleCTCE
@{
    ViewData["Title"] = "Seguimiento dictamen interno (CTCE)";
}

<div class="card shadow">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h6 class="mb-0 py-1"><i class="fas fa-file me-2"></i>@ViewData["Title"]</h6>
        <a asp-action="Index" class="btn btn-outline-secondary btn-sm">
            <i class="fas fa-arrow-left me-2"></i>Volver
        </a>
    </div>

    <div class="card-body overflow-auto px-4 pb-4" style="height: calc(100vh - 164px);">
        <!-- === DATOS GENERALES === -->
        <div class="card border-0 shadow-sm mb-3 overflow-hidden">
            <div class="card-body p-0">

                <!-- Encabezado -->
                <div class="card-header bg-white border-0 pt-3 px-4 pb-0 d-flex justify-content-between align-items-center">
                    <h6 class="fw-bold text-primary mb-0">
                        <i class="fas fa-user-graduate me-2"></i>Datos generales del solicitante
                    </h6>
                    <span class="badge bg-success rounded-pill border">
                        SOLICITADO EL @Model.FechaSolicitud.ToString("dd MMM yyyy")
                    </span>
                </div>

                <div class="row g-0">

                    <!-- Alumno -->
                    <div class="col-lg-3 col-md-4 border-end p-3">
                        <small class="text-muted text-uppercase fw-bold small">Alumno</small>

                        <div class="d-flex align-items-center mt-3">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-3 me-3 text-primary d-flex align-items-center justify-content-center shadow-sm">
                                <i class="fas fa-user fs-5"></i>
                            </div>

                            <div class="overflow-auto">
                                <h6 class="fw-bold text-dark text-wrap mb-1">
                                    @Model.Alumno.Nombre @Model.Alumno.ApellidoPaterno @Model.Alumno.ApellidoMaterno
                                </h6>
                                <span class="text-primary fw-bold small">
                                    @Model.Alumno.NumeroBoleta
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Académico -->
                    <div class="col-lg-2 col-md-4 border-end p-3">
                        <small class="text-muted text-uppercase fw-bold small">Académico</small>

                        <div class="mt-3">
                            <div class="text-dark fw-medium text-wrap" title="@Model.Alumno.Carrera.Nombre">
                                <i class="fas fa-graduation-cap text-muted me-2"></i>
                                @Model.Alumno.Carrera.Nombre
                            </div>

                            <div class="small text-muted mt-2">
                                <span class="fw-bold text-dark">Ingreso:</span> @Model.Alumno.PeriodoIngreso
                            </div>
                        </div>
                    </div>

                    <!-- Dictámenes previos -->
                    <div class="col-lg-2 col-md-4 text-center p-3 border-end">
                        <small class="text-muted text-uppercase fw-bold small">Dictámenes previos</small>

                        <div class="mt-3">
                            @if (Model.TieneDictamenesAnteriores)
                            {
                                <span class="badge bg-warning text-dark py-2 px-3 shadow-sm">
                                    <i class="fas fa-exclamation-circle me-1"></i>SI TENGO
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-success text-light py-2 px-3 shadow-sm">
                                    <i class="fas fa-check-circle me-1"></i>NO TENGO
                                </span>
                            }
                        </div>
                    </div>

                    <!-- Peticion Actual -->
                    <div class="col-lg-5 col-md-12 p-3 bg-light bg-opacity-25">

                        <small class="text-muted text-uppercase fw-bold small">
                            Petición actual
                        </small>

                        <div class="mt-2 small text-secondary lh-sm" style="max-height: 70px; overflow-y: auto;">
                            @Model.Peticion
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <div class="card border-0 shadow-sm mb-4">
            <div class="card-header bg-white border-0 pt-3 px-4 pb-0 d-flex justify-content-between align-items-center">
                <h6 class="fw-bold text-primary mb-0">
                    <i class="fas fa-book me-2"></i>Unidades de aprendizaje reprobadas
                </h6>
                @if (Model.UnidadesReprobadas != null && Model.UnidadesReprobadas.Any())
                {
                    <span class="badge bg-light text-secondary rounded-pill border">
                        @Model.UnidadesReprobadas.Count() registros
                    </span>
                }
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm table-hover align-middle mb-0">
                        <thead class="bg-light text-uppercase small text-muted">
                            <tr class="small">
                                <th class="ps-3 py-3 border-0 rounded-start">Unidad de Aprendizaje</th>
                                <th class="text-center py-3 border-0">Cursó</th>
                                <th class="text-center py-3 border-0 rounded-end">Recursó</th>
                            </tr>
                        </thead>
                        <tbody class="border-top-0">
                            @if (Model.UnidadesReprobadas != null && Model.UnidadesReprobadas.Any())
                            {
                                @foreach (var unidad in Model.UnidadesReprobadas)
                                {
                                    <tr>
                                        <td class="ps-3 border-bottom-0">
                                            <div class="fw-bold text-dark">
                                                @(unidad.UnidadAprendizaje?.Nombre ?? "Sin nombre")
                                            </div>
                                            <small class="text-muted small">CLAVE: @unidad.UnidadAprendizajeId</small>
                                        </td>
                                        <td class="text-center border-bottom-0">
                                            <span class="badge bg-white text-dark fw-normal border shadow-sm">
                                                @unidad.PeriodoCurso
                                            </span>
                                        </td>
                                        <td class="text-center border-bottom-0">
                                            <span class="badge bg-white text-dark fw-normal border shadow-sm">
                                                @unidad.PeriodoRecurse
                                            </span>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="3" class="text-center py-5 border-0">
                                        <div class="text-muted opacity-50">
                                            <i class="fas fa-check-circle fs-1 mb-3"></i>
                                            <p class="mb-0 small">No hay unidades reprobadas registradas.</p>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="d-flex align-items-center mb-4">
            <h6 class="fw-bold text-primary mb-0 me-3">
                <i class="fas fa-tasks me-2"></i>Validación de Expediente
            </h6>
            <div class="bg-secondary opacity-25 flex-grow-1" style="height: 1px;"></div>
        </div>

        <div class="row row-cols-1 row-cols-md-2 row-cols-xl-4 g-4 mb-2">

            <div class="col">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body pb-0">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div class="d-flex align-items-center">
                                <div class="bg-danger bg-opacity-10 text-danger rounded p-2 me-3">
                                    <i class="fas fa-file-pdf fs-4"></i>
                                </div>
                                <div class="overflow-hidden">
                                    <h6 class="fw-bold text-dark mb-0 text-wrap">Carta de motivos</h6>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-primary rounded-pill px-3">Ver</button>
                        </div>
                    </div>
                    <div class="card-footer bg-light border-0 p-3 m-2 rounded-3">
                        <div class="mb-3">
                            <label class="text-secondary fw-bold small mb-1">ESTADO</label>
                            <select asp-items="ViewBag.EstadoDocumento"
                                    name="estadoDocumento"
                                    class="form-select form-select-sm">
                            </select>
                        </div>
                        <div>
                            <textarea class="form-control form-control-sm" rows="2" placeholder="Observaciones..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body pb-0">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div class="d-flex align-items-center">
                                <div class="bg-danger bg-opacity-10 text-danger rounded p-2 me-3">
                                    <i class="fas fa-file-pdf fs-4"></i>
                                </div>
                                <div class="overflow-hidden">
                                    <h6 class="fw-bold text-dark mb-0 text-wrap">Identificación</h6>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-primary rounded-pill px-3">Ver</button>
                        </div>
                    </div>
                    <div class="card-footer bg-light border-0 p-3 m-2 rounded-3">
                        <div class="mb-3">
                            <label class="text-secondary fw-bold small mb-1">ESTADO</label>
                            <select asp-items="ViewBag.EstadoDocumento"
                                    name="estadoDocumento"
                                    class="form-select form-select-sm">
                            </select>

                        </div>
                        <div>
                            <textarea class="form-control form-control-sm" rows="2" placeholder="Observaciones..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body pb-0">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div class="d-flex align-items-center">
                                <div class="bg-danger bg-opacity-10 text-danger rounded p-2 me-3">
                                    <i class="fas fa-file-pdf fs-4"></i>
                                </div>
                                <div class="overflow-hidden">
                                    <h6 class="fw-bold text-dark mb-0 text-wrap">Boleta global</h6>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-primary rounded-pill px-3">Ver</button>
                        </div>
                    </div>
                    <div class="card-footer bg-light border-0 p-3 m-2 rounded-3">
                        <div class="mb-3">
                            <label class="text-secondary fw-bold small mb-1">ESTADO</label>
                            <select asp-items="ViewBag.EstadoDocumento"
                                    name="estadoDocumento"
                                    class="form-select form-select-sm">
                            </select>

                        </div>
                        <div>
                            <textarea class="form-control form-control-sm" rows="2" placeholder="Observaciones..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body pb-0">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div class="d-flex align-items-center">
                                <div class="bg-primary bg-opacity-10 text-danger rounded p-2 me-3">
                                    <i class="fas fa-file-pdf fs-4"></i>
                                </div>
                                <div class="overflow-hidden">
                                    <h6 class="fw-bold text-dark mb-0 text-wrap">Probatorios</h6>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-primary rounded-pill px-3">Ver</button>
                        </div>
                    </div>
                    <div class="card-footer bg-light border-0 p-3 m-2 rounded-3">
                        <div class="mb-3">
                            <label class="text-secondary fw-bold small mb-1">ESTADO</label>
                            <select asp-items="ViewBag.EstadoDocumento"
                                    name="estadoDocumento"
                                    class="form-select form-select-sm">
                            </select>

                        </div>
                        <div>
                            <textarea class="form-control form-control-sm" rows="2" placeholder="Observaciones..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button class="btn btn-sm btn-outline-secondary me-2 btn-sm">Cancelar</button>
        <button class="btn btn-sm btn-primary shadow-sm">
            <i class="fas fa-save me-2"></i>Guardar revisión
        </button>
    </div>
</div>
