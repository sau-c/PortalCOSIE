<!-- Modal Activar/Desactivar -->
<div class="modal fade" id="modalToggle" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"></h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form asp-action="ToggleSesionCOSIE" method="post">
                @Html.AntiForgeryToken()
                <input type="hidden" name="id" />
                <div class="modal-body text-center">
                    <i class="fas fa-3x mb-3"></i>
                    <h6 class="fw-bold mb-2"></h6>
                    <p class="text-muted mb-0">
                        Sesión: <span class="fw-semibold"></span>
                    </p>
                    <p class="text-muted mb-0"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn">
                        <i class="fas me-1"></i>
                        <span></span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const CONFIG = {
            activar: {
                headerClass: 'modal-header bg-success text-white',
                titulo: 'Activar sesión',
                mensaje: '¿Está seguro que desea activar esta sesión?',
                detalle: 'La sesión volverá a estar visible para los usuarios.',
                iconoClass: 'fas fa-eye fa-3x mb-3',
                btnClass: 'btn btn-success',
                btnIconoClass: 'fas fa-eye me-1'
            },
            desactivar: {
                headerClass: 'modal-header bg-danger text-white',
                titulo: 'Desactivar sesión',
                mensaje: '¿Está seguro que desea desactivar esta sesión?',
                detalle: 'Se ocultará la sesión a los demás usuarios.',
                iconoClass: 'fas fa-eye-slash fa-3x mb-3',
                btnClass: 'btn btn-danger',
                btnIconoClass: 'fas fa-eye-slash me-1'
            }
        };

        $(document).on('click', '.btn-toggle-estado', function() {
            const $btn = $(this);
            const id = $btn.data('id');
            const numeroSesion = $btn.data('numero-sesion');
            const isDeleted = $btn.data('isdeleted') === true || $btn.data('isdeleted') === 'True';

            // Determinar estado y obtener configuración
            const estado = isDeleted ? 'activar' : 'desactivar';
            const config = CONFIG[estado];

            // Referencias al modal
            const $modal = $('#modalToggle');

            // Aplicar clases completas (switch de clases)
            $modal.find('.modal-header').attr('class', config.headerClass);
            $modal.find('.modal-body > i').attr('class', config.iconoClass);
            $modal.find('button[type="submit"]').attr('class', config.btnClass);
            $modal.find('button[type="submit"] > i').attr('class', config.btnIconoClass);

            // Aplicar contenido
            $modal.find('.modal-title').text(config.titulo);
            $modal.find('input[name="id"]').val(id);
            $modal.find('.modal-body > h6').text(config.mensaje);
            $modal.find('.modal-body > p:first span').text(numeroSesion);
            $modal.find('.modal-body > p:last').text(config.detalle);
            $modal.find('button[type="submit"] > span').text(config.titulo.split(' ')[0]);
        });
    });
</script>